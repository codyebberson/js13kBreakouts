const t=new AudioContext,e=(...t)=>{a(o(...t))},a=(...e)=>{const a=t.createBuffer(e.length,e[0].length,44100),o=t.createBufferSource();e.map(((t,e)=>a.getChannelData(e).set(t))),o.buffer=a,o.connect(t.destination),o.start()},o=(t=1,e=.05,a=220,o=0,l=0,n=.1,r=0,i=1,f=0,s=0,c=0,d=0,h=0,u=0,m=0,M=0,x=0,g=1,y=0,v=0)=>{const A=2*Math.PI;let k=f*=500*A/44100/44100;e=a*=(1+2*e*Math.random()-e)*A/44100;let p,S,b=[],C=0,E=0,P=0,T=1,B=0,L=0,I=0;for(s*=500*A/44100**3,m*=A/44100,c*=A/44100,d*=44100,h=44100*h|0,S=(o=44100*o+9)+(y*=44100)+(l*=44100)+(n*=44100)+(x*=44100)|0;S>P;b[P++]=I)++L%(100*M|0)||(I=r?r>1?r>2?r>3?Math.sin((C%A)**3):Math.max(Math.min(Math.tan(C),1),-1):1-(2*C/A%2+2)%2:1-4*Math.abs(Math.round(C/A)-C/A):Math.sin(C),I=(h?1-v+v*Math.sin(A*P/h):1)*(I>0?1:-1)*Math.abs(I)**i*t*.3*(o>P?P/o:o+y>P?1-(P-o)/y*(1-g):o+y+l>P?g:S-x>P?(S-P-x)/n*g:0),I=x?I/2+(x>P?0:(S-x>P?1:(S-P)/x)*b[P-x|0]/2):I),p=(a+=f+=s)*Math.cos(m*E++),C+=p-p*u*(1-1e9*(Math.sin(P)+1)%2),T&&++T>d&&(a+=c,e+=c,T=0),!h||++B%h||(a=e,f=k,T=T||1);return b},l=[2.01,,1680,.01,.02,.01,,.95,,-26,417,.02,,,,,.05,.27,.01],n=[1.01,,766,.03,.05,.05,4,.98,,.1,,,,.9,38,.8,,.38,.05],r=[,,172,.01,.04,.06,,1.13,.1,,,,,.9,-101,.2,,.66,.04,.3],i=[.5,0,140,.01,.02,.04,2,1.13,.1,,,,,.9,-101,.2,,.2,.02,.3],f=[,,294,.01,.12,.23,2,.16,-10,10,,.09,.07,.1,,,,.78,.18],s=[1.57,,674,.03,.15,.38,1,.38,-.7,-.1,-9,.14,.19,,43,,.05,.55,.12],c=[,,137,.02,.4,.4,1,1.88,,,39,.16,.05,,,,,.5,.24],d=document.getElementById("c"),h=d.getContext("2d");h.textAlign="center",h.textBaseline="middle";const u=["#700f16","#81161d","#911d25","#a52730"],m=[];let M=0,x=0,g=240,y=690,v=195,A=!1,k=!1,p=0,S=0,b=0,C=0;const E=()=>{for(var t=0;8>t;t++)for(let e=0;7>e;e++)if(1==m[t][e].status){const a=67*e+10,o=23*t+90;m[t][e].x=a,m[t][e].y=o,L(a,o,57,16,u[t/2|0])}for(I(g,y,10),L(v,690,90,16),B(""+b,22,38,"bold 16px Arial"),t=0;3>t;t++)L(216+17*t,24,15,15,C>t?"#fff":"#4e525c")},P=()=>{I(240,460,50),B("â–¶",245,465,"64px Arial","#222733")},T=()=>{const t=localStorage["vanilla-high-score"];t&&B("â™” "+t,240,620,"24px Arial","#888")},B=(t,e,a,o="bold 32px Arial",l="#fff")=>{h.font=o,h.fillStyle=l,h.fillText(t,e,a)},L=(t,e,a,o,l="#fff")=>{h.fillStyle=l,h.beginPath(),h.moveTo(t+2,e),h.arcTo(t+a,e,t+a,e+o,2),h.arcTo(t+a,e+o,t,e+o,2),h.arcTo(t,e+o,t,e,2),h.arcTo(t,e,t+a,e,2),h.fill(),h.closePath()},I=(t,e,a)=>{h.fillStyle="#fff",h.beginPath(),h.arc(t,e,a,0,2*Math.PI),h.fill(),h.closePath()},w=()=>{if(h.fillStyle="#222733",h.fillRect(0,0,480,720),0===M&&(B("js13k",240,120,"64px Arial"),B("Breakout",240,200,"64px Arial","#a52730"),P(),T()),1==M){x>0&&480>x&&(v=x-45),A&&390>v?v+=7:k&&v>0&&(v-=7),(g+p>470||10>g+p)&&(e(...i),p=-p),10>y+S&&(e(...i),S=-S),y>690&&706>y&&g>v&&v+90>g&&(e(...r),y=680,p=.1*(g-v-45),S*=-1.1),y+S>710&&(C--,C?(g=240,y=660,p=6*Math.random()-3,S=-3,e(...f)):(M=3,e(...s)));for(let t=0;7>t;t++)for(let a=0;8>a;a++){let o=m[a][t];1==o.status&&g>o.x&&g<o.x+57&&y>o.y&&y<o.y+16&&(S=-S,o.status=0,b+=10,localStorage["vanilla-high-score"]=Math.max(b,localStorage["vanilla-high-score"]||0),560===b?(M=2,e(...c)):e(...n))}g+=p,y+=S,E()}3==M&&(E(),B("GAME OVER",240,350),P(),T()),2===M&&(E(),B("YOU WIN!",240,350),P(),T()),requestAnimationFrame(w)};document.addEventListener("keydown",(t=>{37===t.keyCode&&(k=!0),39===t.keyCode&&(A=!0)}),!1),document.addEventListener("keyup",(t=>{37===t.keyCode&&(k=!1),39===t.keyCode&&(A=!1)}),!1),document.addEventListener("mousemove",(t=>{x=(t.clientX-d.offsetLeft)/d.offsetWidth*480}),!1),document.addEventListener("click",(()=>{if(1!==M){m.length=0;for(let t=0;8>t;t++){m[t]=[];for(let e=0;7>e;e++)m[t][e]={x:0,y:0,status:1}}b=0,C=3,g=240,y=660,p=6*Math.random()-3,S=-3,e(...l),M=1}})),w();
